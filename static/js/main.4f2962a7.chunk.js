(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{24:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(16),r=n.n(s),o=(n(24),n(3)),l=n(4),i=n(2),j=n(11),u=n(5),b=n.n(u),d=n(8),m=n(19),h=n(10),x=n.n(h),O=function(){var e=Object(d.a)(b.a.mark((function e(t,n){var c,a,s,r,o=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=o.length>2&&void 0!==o[2]?o[2]:null,a=o.length>3&&void 0!==o[3]?o[3]:null,e.prev=2,s="".concat("https://blog-api-1337.herokuapp.com","/api/"),e.next=7,fetch(s+t,{method:n,body:c?JSON.stringify(c):null,headers:{"Content-Type":"application/json"},credentials:"include",signal:a});case 7:return r=e.sent,e.abrupt("return",r);case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,n){return e.apply(this,arguments)}}(),p=O,f=n(0),v=function(e){var t=e.user,n=e.setUser,c=Object(i.f)();return Object(f.jsx)("header",{children:Object(f.jsx)("nav",{className:"navbar navbar-expand-md navbar-dark bg-dark",children:Object(f.jsxs)("div",{className:"container-fluid",children:[Object(f.jsx)("div",{className:"d-flex w-75",children:Object(f.jsx)(l.b,{to:"/",className:"navbar-brand fw-bold d-sm-block d-none me-5",children:"Blog"})}),Object(f.jsx)("button",{className:"navbar-toggler p-1","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",type:"button",children:Object(f.jsx)("span",{className:"navbar-toggler-icon"})}),Object(f.jsx)("div",{className:"collapse navbar-collapse flex-grow-0",id:"navbarNav",children:Object(f.jsxs)("div",{className:"navbar-nav ms-auto",children:[Object(f.jsx)(l.b,{className:"nav-link active link d-sm-none d-block",to:"/",children:"Home"}),!t&&Object(f.jsx)(l.b,{className:"nav-link active link",to:"/login",children:"Login"}),t&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(l.b,{className:"nav-link active link me-3",to:"/post",children:"Post new blog"}),Object(f.jsx)("button",{type:"button",onClick:function(){p("logout","DELETE").then((function(){n(null),c.push("/")})).catch((function(){}))},className:"btn btn-outline-danger",children:"Log out"})]})]})})]})})})},g=function(){return Object(f.jsx)("footer",{className:"py-3 mt-auto bg-white border-top",children:Object(f.jsx)("div",{className:"container-fluid text-center",children:Object(f.jsx)("h5",{className:"",children:"Footer"})})})},N=function(e){var t=e.user,n=e.setUser,a=Object(c.useState)([]),s=Object(o.a)(a,2),r=s[0],i=s[1],j=new AbortController;Object(c.useEffect)((function(){return p("blog","GET",null,j.signal).then((function(e){return e.json()})).then((function(e){return i(e)})).catch((function(){})),function(){return j.abort()}}),[]);var u=function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p("blog","DELETE",{id:t}).then((function(){return window.location.reload()})).catch((function(){}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(v,{user:t,setUser:n}),Object(f.jsx)("main",{className:"",children:Object(f.jsx)("section",{className:"container py-3",children:r.map((function(e){return Object(f.jsxs)("article",{className:"my-5 p-sm-4 p-3 bg-white border rounded",children:[" ",Object(f.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[Object(f.jsxs)("div",{className:"d-flex flex-sm-row flex-column",children:[Object(f.jsx)(l.b,{className:"d-inline-block text-dark text-decoration-none",to:"/post/".concat(e.title.replace(/ /g,"-").toLowerCase()),children:Object(f.jsx)("h5",{className:"link",children:e.title})}),Object(f.jsx)("h5",{className:"opacity-50 ms-sm-3",children:x()(e.date).format("ll")})]}),"admin"===(null===t||void 0===t?void 0:t.role)&&Object(f.jsx)("button",{onClick:function(){return u(e._id)},className:"btn btn-outline-secondary px-2 py-1",type:"button",children:Object(f.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-trash",viewBox:"0 0 16 16",children:[Object(f.jsx)("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),Object(f.jsx)("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]})})]}),Object(f.jsx)(l.b,{className:"d-block mx-auto mb-3",to:"/post/".concat(e.title.replace(/ /g,"-").toLowerCase()),children:Object(f.jsx)("img",{src:e.image,alt:"".concat(e.title)})}),Object(f.jsx)("p",{className:"mb-3 ",children:e.introduction}),Object(f.jsx)(m.a,{smooth:!0,to:"/post/".concat(e.title.replace(/ /g,"-").toLowerCase(),"/#comments"),children:e.comments>1?"".concat(e.comments," comments"):"".concat(e.comments," comment")})]},e._id)}))})}),Object(f.jsx)(g,{})]})},w=function(e){var t=e.user,n=e.setUser,a=Object(c.useState)(""),s=Object(o.a)(a,2),r=s[0],l=s[1],u=Object(c.useState)(""),m=Object(o.a)(u,2),h=m[0],x=m[1],O=Object(c.useState)(""),N=Object(o.a)(O,2),w=N[0],y=N[1],k=Object(i.f)(),C=function(){var e=Object(d.a)(b.a.mark((function e(t){var c,a,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,p("login","POST",{username:h,password:w});case 3:return c=e.sent,e.next=6,null===c||void 0===c?void 0:c.json();case 6:(a=e.sent).success||l(a.message),a.success&&(s=Object(j.a)(a.access_token),n(s),k.push("/"));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(v,{user:t,setUser:n}),Object(f.jsx)("main",{className:"pt-5",children:t?Object(f.jsx)("h1",{className:"text-center",children:"You have already logged in"}):Object(f.jsxs)("form",{className:"container p-3 border rounded text-center bg-white",children:[""!==r&&Object(f.jsx)("div",{className:"alert alert-danger py-2 fw-bold",children:r}),Object(f.jsx)("div",{className:"mb-3",children:Object(f.jsx)("input",{onChange:function(e){return x((function(){return e.target.value}))},placeholder:"Username",type:"text",className:"form-control",autoComplete:"on"})}),Object(f.jsx)("div",{className:"mb-3",children:Object(f.jsx)("input",{onChange:function(e){return y((function(){return e.target.value}))},placeholder:"Password",type:"password",className:"form-control",autoComplete:"on"})}),Object(f.jsx)("button",{onClick:function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),type:"submit",className:"btn btn-dark px-3",children:"Login"})]})}),Object(f.jsx)(g,{})]})},y=function(e){var t=e.user,n=e.setUser,a=Object(c.useState)(""),s=Object(o.a)(a,2),r=s[0],l=s[1],i=Object(c.useState)(""),j=Object(o.a)(i,2),u=j[0],b=j[1],d=Object(c.useState)(""),m=Object(o.a)(d,2),h=m[0],x=m[1],O=Object(c.useState)(""),N=Object(o.a)(O,2),w=N[0],y=N[1],k=Object(c.useState)(""),C=Object(o.a)(k,2),S=C[0],U=C[1];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(v,{user:t,setUser:n}),Object(f.jsx)("main",{className:"py-5",children:"admin"===(null===t||void 0===t?void 0:t.role)?Object(f.jsxs)("form",{className:"p-3 border rounded text-center container bg-white",children:[S.length>0&&Object(f.jsx)("div",{className:"alert alert-primary",children:S}),Object(f.jsx)("div",{className:"mb-3",children:Object(f.jsx)("input",{placeholder:"Title",type:"text",className:"form-control",autoComplete:"on",onChange:function(e){return l(e.target.value)},required:!0})}),Object(f.jsx)("div",{className:"mb-3",children:Object(f.jsx)("input",{type:"file",accept:"image/*",className:"form-control",onChange:function(e){return function(e){var t=new FileReader;t.onloadend=function(){return x(t.result)},t.readAsDataURL(e.target.files[0])}(e)},required:!0})}),Object(f.jsx)("div",{className:"mb-3",children:Object(f.jsx)("input",{placeholder:"Introduction",type:"text",className:"form-control",autoComplete:"on",onChange:function(e){return b(e.target.value)},required:!0})}),Object(f.jsx)("div",{className:"mb-3",children:Object(f.jsx)("textarea",{onChange:function(e){return y(e.target.value)},placeholder:"Text",className:"form-control",required:!0})}),Object(f.jsx)("button",{onClick:function(e){return function(e){e.preventDefault(),p("post","POST",{title:r,image:h,introduction:u,text:w,date:new Date}).then((function(e){return e.json()})).then((function(e){return U(e)})).catch((function(){}))}(e)},type:"submit",className:"btn btn-dark px-3",children:"Post"})]}):Object(f.jsx)("h1",{className:"text-center",children:"Unauthorized Access"})}),Object(f.jsx)(g,{})]})};var k=function(e){var t=e.user,n=e.setUser,a=Object(i.g)().title,s=Object(c.useState)({}),r=Object(o.a)(s,2),l=r[0],j=r[1],u=Object(c.useState)([]),m=Object(o.a)(u,2),h=m[0],O=m[1],N=Object(c.useState)(""),w=Object(o.a)(N,2),y=w[0],k=w[1],C=Object(c.useState)(""),S=Object(o.a)(C,2),U=S[0],E=S[1],T=new AbortController;Object(c.useEffect)((function(){return p("blog/".concat(a),"GET",null,T.signal).then((function(e){return e.json()})).then((function(e){j(e)})).catch((function(e){return console.log(e)})),function(){return T.abort()}}),[]),Object(c.useEffect)((function(){(null===l||void 0===l?void 0:l.text)&&p("comment/".concat(l._id),"GET",null,T.signal).then((function(e){return e.json()})).then((function(e){return O(e)})).catch((function(e){return console.log(e)}))}),[l]);var L=function(){var e=Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p("comment","POST",{name:(null===t||void 0===t?void 0:t.username)||y,role:(null===t||void 0===t?void 0:t.role)||"guest",text:U,date:new Date,blogID:l._id});case 3:window.location.reload(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(v,{user:t,setUser:n}),(null===l||void 0===l?void 0:l.text)?Object(f.jsx)("main",{children:Object(f.jsxs)("div",{className:"container py-5",children:[Object(f.jsx)("section",{className:"",children:Object(f.jsxs)("article",{children:[Object(f.jsx)("h2",{className:"mb-2",children:l.title}),Object(f.jsx)("div",{className:"d-flex opacity-50",children:Object(f.jsx)("h5",{children:x()(l.date).format("ll")})}),Object(f.jsx)("img",{className:"my-4 w-100",src:l.image,alt:l.title}),Object(f.jsx)("p",{className:"pt-3",children:l.text})]})}),Object(f.jsxs)("section",{id:"comments",className:"border-top border-2 mt-5 py-3",children:[Object(f.jsxs)("div",{className:"d-flex py-2",children:[Object(f.jsx)("span",{className:"p-1 me-2 bg-primary"}),Object(f.jsxs)("h5",{children:[l.comments>1?"Comments":"Comment",Object(f.jsx)("span",{className:"ms-2 opacity-50 fs-6",children:"(".concat(l.comments,")")})]})]}),Object(f.jsxs)("form",{className:"border p-3 my-4 rounded d-flex flex-column",children:[t?Object(f.jsx)("h5",{children:t.username}):Object(f.jsx)("input",{className:"form-control w-50",type:"text",placeholder:"Name",onChange:function(e){return k(e.target.value)},required:!0}),Object(f.jsx)("textarea",{className:"form-control mt-3",rows:"4",required:!0,onChange:function(e){return E(e.target.value)}}),Object(f.jsx)("button",{className:"btn btn-outline-primary mt-3 w-50 mx-auto",type:"button",onClick:function(){return L()},children:"Post"})]}),h.map((function(e){return Object(f.jsxs)("div",{className:"py-3 border-bottom",children:[Object(f.jsxs)("div",{className:"d-flex mb-1 flex-sm-row flex-column",children:[Object(f.jsxs)("div",{className:"d-flex align-items-center",children:["admin"===e.role&&Object(f.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-patch-check-fill me-1 text-success",viewBox:"0 0 16 16",children:Object(f.jsx)("path",{d:"M10.067.87a2.89 2.89 0 0 0-4.134 0l-.622.638-.89-.011a2.89 2.89 0 0 0-2.924 2.924l.01.89-.636.622a2.89 2.89 0 0 0 0 4.134l.637.622-.011.89a2.89 2.89 0 0 0 2.924 2.924l.89-.01.622.636a2.89 2.89 0 0 0 4.134 0l.622-.637.89.011a2.89 2.89 0 0 0 2.924-2.924l-.01-.89.636-.622a2.89 2.89 0 0 0 0-4.134l-.637-.622.011-.89a2.89 2.89 0 0 0-2.924-2.924l-.89.01-.622-.636zm.287 5.984-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708.708z"})}),Object(f.jsx)("p",{className:"fw-bold",children:e.name})]}),Object(f.jsx)("p",{className:"opacity-50 ms-sm-2",children:x()(e.date).fromNow()})]}),Object(f.jsx)("p",{children:e.text})]},e._id)}))]})]})}):Object(f.jsx)("h1",{className:"py-5 text-center",children:l.message}),Object(f.jsx)(g,{})]})},C=function(e){var t=e.user,n=e.setUser;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(v,{user:t,setUser:n}),Object(f.jsx)("div",{children:Object(f.jsx)("h1",{className:"text-center py-5",children:"404 Page Not Found"})}),Object(f.jsx)(g,{})]})},S=function(){var e=Object(c.useState)(null),t=Object(o.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(!1),r=Object(o.a)(s,2),u=r[0],b=r[1];return Object(c.useEffect)((function(){n||(b(!0),p("refresh","POST").then((function(e){return e.json()})).then((function(e){if(e.access_token){var t=Object(j.a)(e.access_token);a(t)}b(!1)})).catch((function(){b(!1)})))}),[n]),Object(f.jsx)(l.a,{basename:"/blog-api",children:u?null:Object(f.jsxs)(i.c,{children:[Object(f.jsx)(i.a,{exact:!0,path:"/",children:Object(f.jsx)(N,{user:n,setUser:a})}),Object(f.jsx)(i.a,{exact:!0,path:"/login",children:Object(f.jsx)(w,{user:n,setUser:a})}),Object(f.jsx)(i.a,{exact:!0,path:"/post",children:Object(f.jsx)(y,{user:n,setUser:a})}),Object(f.jsx)(i.a,{exact:!0,path:"/post/:title",children:Object(f.jsx)(k,{user:n,setUser:a})}),Object(f.jsx)(i.a,{children:Object(f.jsx)(C,{user:n,setUser:a})})]})})};r.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(S,{})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.4f2962a7.chunk.js.map